<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Visite 360 cepegra</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
  </head>
</html>
<body>
  <a-scene renderer="antialias: true; colorManagement: true;" loading-screen="dotsColor: orange; backgroundColor: black">
    <a-assets>
      <img id="rez_entree" src="assets/cepegra/rez_entree.JPG" preload crossorigin></img>
      <img id="rez_accueil" src="assets/cepegra/rez_accueil.jpg" preload crossorigin></img>
      <img id="rez_couloir_2" src="assets/cepegra/rez_couloir_2.JPG" preload crossorigin></img>
      <img id="rez_couloir_3" src="assets/cepegra/rez_couloir_3.jpg" preload crossorigin></img>
      <img id="rez_atelier" src="assets/cepegra/rez_atelier.jpg" preload crossorigin></img>
      <img id="1_couloir_1" src="assets/cepegra/1_couloir_1.JPG" preload crossorigin></img>
      <img id="1_couloir_2" src="assets/cepegra/1_couloir_2.JPG" preload crossorigin></img>
      <img id="1_couloir_3" src="assets/cepegra/1_couloir_3.jpg" preload crossorigin></img>
      <img id="1_hall" src="assets/cepegra/1_hall.jpg" preload crossorigin></img>
      <img id="1_passerelle" src="assets/cepegra/1_passerelle.JPG" preload crossorigin></img>
      <img id="2_hall" src="assets/cepegra/2_hall.jpg" preload crossorigin></img>

      <a-mixin
          id="viewsphere"
          position="0 -100 0"
          geometry="primitive: sphere; radius:20; segmentsWidth:128; segmentsHeight:128"
          material="shader:flat; side: back; repeat:-1 1;"
          sound="autoplay:true; loop:true; maxDistance:50; poolSize:10"
        ></a-mixin>


        <a-mixin
        id="marker" 
        position="0 0 10"
        geometry="primitive: circle; radius:2"
        material="shader:flat; color:red; opacity:0.5;side:double;"
        animation="property:geometry.radius; to:1.5; dur:1000; loop:true;dir:alternate;"
        event-set__enter="_event: mouseenter; scale:1.5 1.5 1.5;"
        event-set__leave="_event: mouseleave; scale:1 1 1;"
        ></a-mixin>

    </a-assets>

    <!-- TEST -->
    <a-entity id="view_1" mixin="viewsphere" material="src: #rez_accueil;" position="0 0 0" sound="src: #demosound1" autoplaysound>
      <a-entity position="0 0 0" rotation="5 0 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_1; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_2; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
        </a-entity>
      </a-entity>
      <a-entity position="0 0 0" rotation="5 30 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_1; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_7; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
        </a-entity>
      </a-entity>
      <a-entity position="0 0 0" rotation="5 275 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_1; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_11; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
        </a-entity>
      </a-entity>
    </a-entity>
    
    <a-entity id="view_2" mixin="viewsphere" material="src: #rez_couloir_2;" sound="src: #demosound2;" autoplaysound>
      <a-entity position="0 0 0" rotation="5 280 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_2; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_1; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
        </a-entity>
      </a-entity>
      <a-entity position="0 0 0" rotation="5 185 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_2; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_3; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
        </a-entity>
      </a-entity>
    </a-entity>
    <a-entity id="view_3" mixin="viewsphere" material="src: #rez_couloir_3;" sound="src: #demosound2;" autoplaysound>
      <a-entity position="0 0 0" rotation="5 265 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_3; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_2; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>  
      <a-entity position="0 0 0" rotation="5 170 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_3; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_4; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
        <a-entity position="0 0 0" rotation="5 70 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_3; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_5; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
    </a-entity>
    <a-entity id="view_4" mixin="viewsphere" material="src: #rez_atelier;" sound="src: #demosound2;" autoplaysound>
        <a-entity position="0 0 0" rotation="5 270.5 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_4; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_3; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
    </a-entity>

    <a-entity id="view_5" mixin="viewsphere" material="src: #1_couloir_1;" sound="src: #demosound2;" autoplaysound>
        <a-entity position="0 0 0" rotation="5 340 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_5; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_10; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
        <a-entity position="0 0 0" rotation="5 290 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_5; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_3; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
        <a-entity position="0 0 0" rotation="5 93 0">
          <a-entity
            mixin="marker"
            event-set__hideview="_event: mousedown; _target:#view_5; position:0 -100 0;"
            event-set__showview="_event: mousedown; _target:#view_6; position:0 0 0;" 
            event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
          >
            </a-entity>
        </a-entity>
    </a-entity>
    <a-entity id="view_6" mixin="viewsphere" material="src: #1_couloir_2;" sound="src: #demosound2;" autoplaysound>
      <a-entity position="0 0 0" rotation="5 260 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_6; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_5; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
          </a-entity>
      </a-entity>
      <a-entity position="0 0 0" rotation="5 0 0">
        <a-entity
          mixin="marker"
          event-set__hideview="_event: mousedown; _target:#view_6; position:0 -100 0;"
          event-set__showview="_event: mousedown; _target:#view_7; position:0 0 0;" 
          event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
        >
          </a-entity>
      </a-entity>
  </a-entity>
  <a-entity id="view_7" mixin="viewsphere" material="src: #1_hall;" sound="src: #demosound2;" autoplaysound>
    <a-entity position="0 0 0" rotation="5 258 0">
      <a-entity
        mixin="marker"
        event-set__hideview="_event: mousedown; _target:#view_7; position:0 -100 0;"
        event-set__showview="_event: mousedown; _target:#view_6; position:0 0 0;" 
        event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
      >
        </a-entity>
    </a-entity>
    <a-entity position="0 0 0" rotation="-15 300 0">
      <a-entity
        mixin="marker"
        event-set__hideview="_event: mousedown; _target:#view_7; position:0 -100 0;"
        event-set__showview="_event: mousedown; _target:#view_9; position:0 0 0;" 
        event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
      >
        </a-entity>
    </a-entity>
    <a-entity position="0 0 0" rotation="5 -26 0">
      <a-entity
        mixin="marker"
        event-set__hideview="_event: mousedown; _target:#view_7; position:0 -100 0;"
        event-set__showview="_event: mousedown; _target:#view_1; position:0 0 0;" 
        event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
      >
        </a-entity>
    </a-entity>
</a-entity>
<a-entity id="view_8" mixin="viewsphere" material="src: #1_passerelle;" sound="src: #demosound2;" autoplaysound>
  <a-entity position="0 0 0" rotation="5 295 0">
    <a-entity
      mixin="marker"
      event-set__hideview="_event: mousedown; _target:#view_8; position:0 -100 0;"
      event-set__showview="_event: mousedown; _target:#view_10; position:0 0 0;" 
      event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
    >
      </a-entity>
  </a-entity>

</a-entity>
<a-entity id="view_9" mixin="viewsphere" material="src: #2_hall;" sound="src: #demosound2;" autoplaysound>
  <a-entity position="0 0 0" rotation="30 295 0">
    <a-entity
      mixin="marker"
      event-set__hideview="_event: mousedown; _target:#view_9; position:0 -100 0;"
      event-set__showview="_event: mousedown; _target:#view_7; position:0 0 0;" 
      event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
    >
      </a-entity>
  </a-entity>

</a-entity>
<a-entity id="view_10" mixin="viewsphere" material="src: #1_couloir_3;" sound="src: #demosound2;" autoplaysound>
  <a-entity position="0 0 0" rotation="5 90 0">
    <a-entity
      mixin="marker"
      event-set__hideview="_event: mousedown; _target:#view_10; position:0 -100 0;"
      event-set__showview="_event: mousedown; _target:#view_5; position:0 0 0;" 
      event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
    >
      </a-entity>
  </a-entity>
  <a-entity position="0 0 0" rotation="5 270 0">
    <a-entity
      mixin="marker"
      event-set__hideview="_event: mousedown; _target:#view_10; position:0 -100 0;"
      event-set__showview="_event: mousedown; _target:#view_8; position:0 0 0;" 
      event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
    >
      </a-entity>
  </a-entity>

</a-entity>
<a-entity id="view_11" mixin="viewsphere" material="src: #rez_entree;" sound="src: #demosound2;" autoplaysound>
  <a-entity position="0 0 0" rotation="5 275 0">
    <a-entity
      mixin="marker"
      event-set__hideview="_event: mousedown; _target:#view_11; position:0 -100 0;"
      event-set__showview="_event: mousedown; _target:#view_1; position:0 0 0;" 
      event-set__orient="_event: mousedown; _target:#rig; rotation:0 -100 0;"
    >
      </a-entity>
  </a-entity>
</a-entity>


<!-- RIG -->
<a-entity id="rig" rotation="0 0 0">
  <!-- HMD -->
  <a-entity id="hmd" camera="far:20" look-controls   position="0 0 0">
    <a-entity cursor="rayOrigin: mouse" raycaster="objects:[mixin=marker]; far:20;"></a-entity>
  </a-entity>

  <!-- RIGHT CONTROLLER -->
  <a-entity
  laser-controls="hand: right;"
  raycaster="lineColor: red; objets: [mixin=marker]; far:20"
  ></a-entity>

  <!-- LEFT CONTROLLER -->
  <a-entity
    laser-controls="hand: left;"
    raycaster="lineColor: green; objets: [mixin=marker]; far:20"
  ></a-entity>

</a-entity>

  </a-scene>

  <script>
    document.addEventListener("click", ()=>{
      var entity = document.querySelector('[autoplaysound]');
      entity.components.sound.playSound();

    })
  </script>
</body>
</html>